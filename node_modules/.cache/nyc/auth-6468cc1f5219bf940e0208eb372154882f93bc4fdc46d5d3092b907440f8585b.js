function cov_c3w0so3ws(){var path="/Users/dominikfaber/Development/repos/domnode1/routes/auth.js";var hash="460eb17bd2a61e513ddf955cf926844385aed04e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/dominikfaber/Development/repos/domnode1/routes/auth.js",statementMap:{"0":{start:{line:2,column:12},end:{line:2,column:35}},"1":{start:{line:3,column:14},end:{line:3,column:32}},"2":{start:{line:4,column:13},end:{line:4,column:29}},"3":{start:{line:5,column:22},end:{line:5,column:67}},"4":{start:{line:6,column:17},end:{line:6,column:49}},"5":{start:{line:10,column:0},end:{line:12,column:4}},"6":{start:{line:11,column:2},end:{line:11,column:33}},"7":{start:{line:15,column:0},end:{line:44,column:3}},"8":{start:{line:18,column:13},end:{line:18,column:58}},"9":{start:{line:19,column:2},end:{line:38,column:3}},"10":{start:{line:20,column:4},end:{line:20,column:40}},"11":{start:{line:25,column:21},end:{line:25,column:66}},"12":{start:{line:26,column:4},end:{line:26,column:28}},"13":{start:{line:27,column:4},end:{line:37,column:5}},"14":{start:{line:28,column:6},end:{line:28,column:42}},"15":{start:{line:33,column:18},end:{line:33,column:45}},"16":{start:{line:34,column:6},end:{line:34,column:29}},"17":{start:{line:36,column:6},end:{line:36,column:57}},"18":{start:{line:47,column:0},end:{line:47,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:48},end:{line:10,column:49}},loc:{start:{line:10,column:67},end:{line:12,column:1}},line:10},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:23},end:{line:15,column:24}},loc:{start:{line:15,column:49},end:{line:44,column:1}},line:15}},branchMap:{"0":{loc:{start:{line:19,column:2},end:{line:38,column:3}},type:"if",locations:[{start:{line:19,column:2},end:{line:38,column:3}},{start:{line:19,column:2},end:{line:38,column:3}}],line:19},"1":{loc:{start:{line:27,column:4},end:{line:37,column:5}},type:"if",locations:[{start:{line:27,column:4},end:{line:37,column:5}},{start:{line:27,column:4},end:{line:37,column:5}}],line:27}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"460eb17bd2a61e513ddf955cf926844385aed04e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_c3w0so3ws=function(){return actualCoverage;};return actualCoverage;}cov_c3w0so3ws();/* User Signup & Authentication */const jwt=(cov_c3w0so3ws().s[0]++,require('jsonwebtoken'));var express=(cov_c3w0so3ws().s[1]++,require('express'));var router=(cov_c3w0so3ws().s[2]++,express.Router());var UsersController=(cov_c3w0so3ws().s[3]++,require('../controllers/users.controller.js'));const{User}=(cov_c3w0so3ws().s[4]++,require("../models/users.model"));// Signup
cov_c3w0so3ws().s[5]++;router.post('/signup',[UsersController.insert,function(req,res){cov_c3w0so3ws().f[0]++;cov_c3w0so3ws().s[6]++;res.send({_id:req.body._id});}]);//Signin
cov_c3w0so3ws().s[7]++;router.post('/signin',async function(req,res){cov_c3w0so3ws().f[1]++;let user=(cov_c3w0so3ws().s[8]++,await User.findOne({email:req.body.email}));cov_c3w0so3ws().s[9]++;if(user===null){cov_c3w0so3ws().b[0][0]++;cov_c3w0so3ws().s[10]++;res.send("Wrong email or username");}else{cov_c3w0so3ws().b[0][1]++;//Check if email exists and password is correct
//if not send a general message like email or password not valid
let permission=(cov_c3w0so3ws().s[11]++,await user.isValidPassword(req.body.password));cov_c3w0so3ws().s[12]++;console.log(permission);cov_c3w0so3ws().s[13]++;if(!permission){cov_c3w0so3ws().b[1][0]++;cov_c3w0so3ws().s[14]++;res.send("Wrong email or username");}else{cov_c3w0so3ws().b[1][1]++;//Sign jwt
//Todo: Add user_id to the token payload and place the function to auth middleware
//Todo: Add secret to env variable
let token=(cov_c3w0so3ws().s[15]++,jwt.sign(req.body,"dommi"));cov_c3w0so3ws().s[16]++;req.body.token=token;//add jwt to req
cov_c3w0so3ws().s[17]++;res.send({token:req.body.token,userID:user._id});}}//next
});cov_c3w0so3ws().s[18]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGguanMiXSwibmFtZXMiOlsiand0IiwicmVxdWlyZSIsImV4cHJlc3MiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJVc2Vyc0NvbnRyb2xsZXIiLCJVc2VyIiwicG9zdCIsImluc2VydCIsInJlcSIsInJlcyIsInNlbmQiLCJfaWQiLCJib2R5IiwidXNlciIsImZpbmRPbmUiLCJlbWFpbCIsInBlcm1pc3Npb24iLCJpc1ZhbGlkUGFzc3dvcmQiLCJwYXNzd29yZCIsImNvbnNvbGUiLCJsb2ciLCJ0b2tlbiIsInNpZ24iLCJ1c2VySUQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiK2dGQUFBLGtDQUNBLEtBQU1BLENBQUFBLEdBQUcseUJBQUdDLE9BQU8sQ0FBQyxjQUFELENBQVYsQ0FBVCxDQUNBLEdBQUlDLENBQUFBLE9BQU8seUJBQUdELE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBWCxDQUNBLEdBQUlFLENBQUFBLE1BQU0seUJBQUdELE9BQU8sQ0FBQ0UsTUFBUixFQUFILENBQVYsQ0FDQSxHQUFJQyxDQUFBQSxlQUFlLHlCQUFHSixPQUFPLENBQUMsb0NBQUQsQ0FBVixDQUFuQixDQUNBLEtBQU0sQ0FBRUssSUFBRiwwQkFBV0wsT0FBTyxDQUFDLHVCQUFELENBQWxCLENBQU4sQ0FHQTt1QkFDQUUsTUFBTSxDQUFDSSxJQUFQLENBQVksU0FBWixDQUF1QixDQUFDRixlQUFlLENBQUNHLE1BQWpCLENBQXlCLFNBQVVDLEdBQVYsQ0FBY0MsR0FBZCxDQUFtQiwrQ0FDakVBLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLENBQUNDLEdBQUcsQ0FBR0gsR0FBRyxDQUFDSSxJQUFKLENBQVNELEdBQWhCLENBQVQsRUFDRCxDQUZzQixDQUF2QixFQUlBO3VCQUNBVCxNQUFNLENBQUNJLElBQVAsQ0FBWSxTQUFaLENBQXVCLGVBQWdCRSxHQUFoQixDQUFxQkMsR0FBckIsQ0FBMEIsd0JBRy9DLEdBQUlJLENBQUFBLElBQUkseUJBQUcsS0FBTVIsQ0FBQUEsSUFBSSxDQUFDUyxPQUFMLENBQWEsQ0FBRUMsS0FBSyxDQUFFUCxHQUFHLENBQUNJLElBQUosQ0FBU0csS0FBbEIsQ0FBYixDQUFULENBQVIsQ0FIK0MsdUJBSS9DLEdBQUtGLElBQUksR0FBSyxJQUFkLENBQW9CLG1EQUNsQkosR0FBRyxDQUFDQyxJQUFKLENBQVMseUJBQVQsRUFDRCxDQUZELElBRU8sMkJBRUw7QUFDQTtBQUNBLEdBQUlNLENBQUFBLFVBQVUsMEJBQUcsS0FBTUgsQ0FBQUEsSUFBSSxDQUFDSSxlQUFMLENBQXFCVCxHQUFHLENBQUNJLElBQUosQ0FBU00sUUFBOUIsQ0FBVCxDQUFkLENBSkssd0JBS0xDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSixVQUFaLEVBTEssd0JBTUwsR0FBSSxDQUFDQSxVQUFMLENBQWlCLG1EQUNmUCxHQUFHLENBQUNDLElBQUosQ0FBUyx5QkFBVCxFQUNELENBRkQsSUFFTywyQkFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFJVyxDQUFBQSxLQUFLLDBCQUFHdEIsR0FBRyxDQUFDdUIsSUFBSixDQUFTZCxHQUFHLENBQUNJLElBQWIsQ0FBbUIsT0FBbkIsQ0FBSCxDQUFULENBSkssd0JBS0xKLEdBQUcsQ0FBQ0ksSUFBSixDQUFTUyxLQUFULENBQWlCQSxLQUFqQixDQUNBO0FBTkssd0JBT0xaLEdBQUcsQ0FBQ0MsSUFBSixDQUFTLENBQUNXLEtBQUssQ0FBQ2IsR0FBRyxDQUFDSSxJQUFKLENBQVNTLEtBQWhCLENBQXVCRSxNQUFNLENBQUVWLElBQUksQ0FBQ0YsR0FBcEMsQ0FBVCxFQUNELENBQ0YsQ0FLRDtBQUNELENBN0JELEUsd0JBZ0NBYSxNQUFNLENBQUNDLE9BQVAsQ0FBaUJ2QixNQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIFVzZXIgU2lnbnVwICYgQXV0aGVudGljYXRpb24gKi9cbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xudmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG52YXIgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbnZhciBVc2Vyc0NvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy91c2Vycy5jb250cm9sbGVyLmpzJyk7XG5jb25zdCB7IFVzZXIgfSA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvdXNlcnMubW9kZWxcIik7XG5cblxuLy8gU2lnbnVwXG5yb3V0ZXIucG9zdCgnL3NpZ251cCcsIFtVc2Vyc0NvbnRyb2xsZXIuaW5zZXJ0LCBmdW5jdGlvbiAocmVxLHJlcykge1xuICByZXMuc2VuZCh7X2lkIDogcmVxLmJvZHkuX2lkfSk7XG59XSk7XG5cbi8vU2lnbmluXG5yb3V0ZXIucG9zdCgnL3NpZ25pbicsIGFzeW5jIGZ1bmN0aW9uIChyZXEsIHJlcykge1xuXG5cbiAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBlbWFpbDogcmVxLmJvZHkuZW1haWwgfSk7XG4gIGlmICAodXNlciA9PT0gbnVsbCkge1xuICAgIHJlcy5zZW5kKFwiV3JvbmcgZW1haWwgb3IgdXNlcm5hbWVcIik7XG4gIH0gZWxzZSB7XG5cbiAgICAvL0NoZWNrIGlmIGVtYWlsIGV4aXN0cyBhbmQgcGFzc3dvcmQgaXMgY29ycmVjdFxuICAgIC8vaWYgbm90IHNlbmQgYSBnZW5lcmFsIG1lc3NhZ2UgbGlrZSBlbWFpbCBvciBwYXNzd29yZCBub3QgdmFsaWRcbiAgICBsZXQgcGVybWlzc2lvbiA9IGF3YWl0IHVzZXIuaXNWYWxpZFBhc3N3b3JkKHJlcS5ib2R5LnBhc3N3b3JkKTtcbiAgICBjb25zb2xlLmxvZyhwZXJtaXNzaW9uKTtcbiAgICBpZiAoIXBlcm1pc3Npb24pIHtcbiAgICAgIHJlcy5zZW5kKFwiV3JvbmcgZW1haWwgb3IgdXNlcm5hbWVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vU2lnbiBqd3RcbiAgICAgIC8vVG9kbzogQWRkIHVzZXJfaWQgdG8gdGhlIHRva2VuIHBheWxvYWQgYW5kIHBsYWNlIHRoZSBmdW5jdGlvbiB0byBhdXRoIG1pZGRsZXdhcmVcbiAgICAgIC8vVG9kbzogQWRkIHNlY3JldCB0byBlbnYgdmFyaWFibGVcbiAgICAgIGxldCB0b2tlbiA9IGp3dC5zaWduKHJlcS5ib2R5LCBcImRvbW1pXCIpO1xuICAgICAgcmVxLmJvZHkudG9rZW4gPSB0b2tlbjtcbiAgICAgIC8vYWRkIGp3dCB0byByZXFcbiAgICAgIHJlcy5zZW5kKHt0b2tlbjpyZXEuYm9keS50b2tlbiwgdXNlcklEOiB1c2VyLl9pZH0pO1xuICAgIH1cbiAgfVxuXG5cblxuXG4gIC8vbmV4dFxufSk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXX0=